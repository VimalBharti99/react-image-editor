{"ast":null,"code":"import React,{useEffect,useRef}from\"react\";import{useLocation}from\"react-router-dom\";import{Canvas,Image as FabricImage,IText,Rect,Circle,Triangle,Polygon}from\"fabric\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const EditorPage=()=>{var _location$state;const canvasRef=useRef(null);const fabricCanvasRef=useRef(null);const location=useLocation();const imgUrl=(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.imgUrl;useEffect(()=>{if(!imgUrl)return;if(fabricCanvasRef.current){fabricCanvasRef.current.dispose();}const canvas=new Canvas(canvasRef.current,{width:800,height:500});fabricCanvasRef.current=canvas;FabricImage.fromURL(imgUrl,img=>{img.set({left:0,top:0,selectable:false});img.scaleToWidth(800);canvas.setBackgroundImage(img,canvas.renderAll.bind(canvas));});return()=>canvas.dispose();},[imgUrl]);const addText=()=>{const canvas=fabricCanvasRef.current;const text=new IText(\"Edit me\",{left:50,top:50,fontSize:24,fill:\"black\"});canvas.add(text);canvas.setActiveObject(text);};const addRectangle=()=>{const rect=new Rect({left:100,top:100,fill:\"rgba(255, 0, 0, 0.5)\",width:120,height:80});fabricCanvasRef.current.add(rect);};const addCircle=()=>{const circle=new Circle({left:150,top:150,radius:50,fill:\"rgba(0, 0, 255, 0.5)\"});fabricCanvasRef.current.add(circle);};const addTriangle=()=>{const triangle=new Triangle({left:200,top:200,width:100,height:100,fill:\"rgba(0, 255, 0, 0.5)\"});fabricCanvasRef.current.add(triangle);};const addPolygon=()=>{const polygon=new Polygon([{x:200,y:100},{x:250,y:150},{x:300,y:100},{x:275,y:50},{x:225,y:50}],{left:250,top:100,fill:\"rgba(255, 255, 0, 0.5)\"});fabricCanvasRef.current.add(polygon);};const downloadImage=()=>{const dataURL=fabricCanvasRef.current.toDataURL({format:\"png\"});const link=document.createElement(\"a\");link.href=dataURL;link.download=\"edited-image.png\";link.click();};const logCanvasLayers=()=>{const canvas=fabricCanvasRef.current;if(!canvas)return;const layers=canvas.getObjects().map(obj=>{const layerInfo={type:obj.type,left:obj.left,top:obj.top,angle:obj.angle,scaleX:obj.scaleX,scaleY:obj.scaleY};if(obj.type===\"i-text\"){layerInfo.text=obj.text;layerInfo.fill=obj.fill;layerInfo.fontSize=obj.fontSize;}if([\"rect\",\"circle\",\"triangle\",\"polygon\"].includes(obj.type)){layerInfo.fill=obj.fill;if(obj.width)layerInfo.width=obj.width;if(obj.height)layerInfo.height=obj.height;}if(obj.type===\"image\"){var _obj$getSrc;layerInfo.src=(_obj$getSrc=obj.getSrc)===null||_obj$getSrc===void 0?void 0:_obj$getSrc.call(obj);}return layerInfo;});console.log(\"ðŸ§  Canvas Layers:\",layers);};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-4\",children:\"Edit Image\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 flex flex-wrap gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:addText,className:\"bg-blue-500 text-white px-3 py-1 rounded\",children:\"Add Text\"}),/*#__PURE__*/_jsx(\"button\",{onClick:addRectangle,className:\"bg-green-500 text-white px-3 py-1 rounded\",children:\"Add Rectangle\"}),/*#__PURE__*/_jsx(\"button\",{onClick:addCircle,className:\"bg-purple-500 text-white px-3 py-1 rounded\",children:\"Add Circle\"}),/*#__PURE__*/_jsx(\"button\",{onClick:addTriangle,className:\"bg-pink-500 text-white px-3 py-1 rounded\",children:\"Add Triangle\"}),/*#__PURE__*/_jsx(\"button\",{onClick:addPolygon,className:\"bg-yellow-500 text-black px-3 py-1 rounded\",children:\"Add Polygon\"}),/*#__PURE__*/_jsx(\"button\",{onClick:downloadImage,className:\"bg-black text-white px-3 py-1 rounded\",children:\"Download Image\"}),/*#__PURE__*/_jsx(\"button\",{onClick:logCanvasLayers,className:\"bg-indigo-600 text-white px-4 py-2 rounded mt-4\",children:\"\\uD83E\\uDDE0 Log Canvas Layers\"})]}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef})]});};export default EditorPage;","map":{"version":3,"names":["React","useEffect","useRef","useLocation","Canvas","Image","FabricImage","IText","Rect","Circle","Triangle","Polygon","jsx","_jsx","jsxs","_jsxs","EditorPage","_location$state","canvasRef","fabricCanvasRef","location","imgUrl","state","current","dispose","canvas","width","height","fromURL","img","set","left","top","selectable","scaleToWidth","setBackgroundImage","renderAll","bind","addText","text","fontSize","fill","add","setActiveObject","addRectangle","rect","addCircle","circle","radius","addTriangle","triangle","addPolygon","polygon","x","y","downloadImage","dataURL","toDataURL","format","link","document","createElement","href","download","click","logCanvasLayers","layers","getObjects","map","obj","layerInfo","type","angle","scaleX","scaleY","includes","_obj$getSrc","src","getSrc","call","console","log","className","children","onClick","ref"],"sources":["D:/React/react-image-editor/src/pages/EditorPage.jsx"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport {\r\n  Canvas,\r\n  Image as FabricImage,\r\n  IText,\r\n  Rect,\r\n  Circle,\r\n  Triangle,\r\n  Polygon,\r\n} from \"fabric\";\r\n\r\nconst EditorPage = () => {\r\n  const canvasRef = useRef(null);\r\n  const fabricCanvasRef = useRef(null);\r\n  const location = useLocation();\r\n  const imgUrl = location.state?.imgUrl;\r\n\r\n  useEffect(() => {\r\n    if (!imgUrl) return;\r\n\r\n    if (fabricCanvasRef.current) {\r\n      fabricCanvasRef.current.dispose();\r\n    }\r\n\r\n    const canvas = new Canvas(canvasRef.current, {\r\n      width: 800,\r\n      height: 500,\r\n    });\r\n    fabricCanvasRef.current = canvas;\r\n\r\n    FabricImage.fromURL(imgUrl, (img) => {\r\n      img.set({\r\n        left: 0,\r\n        top: 0,\r\n        selectable: false,\r\n      });\r\n      img.scaleToWidth(800);\r\n      canvas.setBackgroundImage(img, canvas.renderAll.bind(canvas));\r\n    });\r\n\r\n    return () => canvas.dispose();\r\n  }, [imgUrl]);\r\n\r\n  const addText = () => {\r\n    const canvas = fabricCanvasRef.current;\r\n    const text = new IText(\"Edit me\", {\r\n      left: 50,\r\n      top: 50,\r\n      fontSize: 24,\r\n      fill: \"black\",\r\n    });\r\n    canvas.add(text);\r\n    canvas.setActiveObject(text);\r\n  };\r\n\r\n  const addRectangle = () => {\r\n    const rect = new Rect({\r\n      left: 100,\r\n      top: 100,\r\n      fill: \"rgba(255, 0, 0, 0.5)\",\r\n      width: 120,\r\n      height: 80,\r\n    });\r\n    fabricCanvasRef.current.add(rect);\r\n  };\r\n\r\n  const addCircle = () => {\r\n    const circle = new Circle({\r\n      left: 150,\r\n      top: 150,\r\n      radius: 50,\r\n      fill: \"rgba(0, 0, 255, 0.5)\",\r\n    });\r\n    fabricCanvasRef.current.add(circle);\r\n  };\r\n\r\n  const addTriangle = () => {\r\n    const triangle = new Triangle({\r\n      left: 200,\r\n      top: 200,\r\n      width: 100,\r\n      height: 100,\r\n      fill: \"rgba(0, 255, 0, 0.5)\",\r\n    });\r\n    fabricCanvasRef.current.add(triangle);\r\n  };\r\n\r\n  const addPolygon = () => {\r\n    const polygon = new Polygon(\r\n      [\r\n        { x: 200, y: 100 },\r\n        { x: 250, y: 150 },\r\n        { x: 300, y: 100 },\r\n        { x: 275, y: 50 },\r\n        { x: 225, y: 50 },\r\n      ],\r\n      {\r\n        left: 250,\r\n        top: 100,\r\n        fill: \"rgba(255, 255, 0, 0.5)\",\r\n      }\r\n    );\r\n    fabricCanvasRef.current.add(polygon);\r\n  };\r\n\r\n  const downloadImage = () => {\r\n    const dataURL = fabricCanvasRef.current.toDataURL({ format: \"png\" });\r\n    const link = document.createElement(\"a\");\r\n    link.href = dataURL;\r\n    link.download = \"edited-image.png\";\r\n    link.click();\r\n  };\r\n\r\n  const logCanvasLayers = () => {\r\n    const canvas = fabricCanvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    const layers = canvas.getObjects().map((obj) => {\r\n      const layerInfo = {\r\n        type: obj.type,\r\n        left: obj.left,\r\n        top: obj.top,\r\n        angle: obj.angle,\r\n        scaleX: obj.scaleX,\r\n        scaleY: obj.scaleY,\r\n      };\r\n\r\n      if (obj.type === \"i-text\") {\r\n        layerInfo.text = obj.text;\r\n        layerInfo.fill = obj.fill;\r\n        layerInfo.fontSize = obj.fontSize;\r\n      }\r\n\r\n      if ([\"rect\", \"circle\", \"triangle\", \"polygon\"].includes(obj.type)) {\r\n        layerInfo.fill = obj.fill;\r\n        if (obj.width) layerInfo.width = obj.width;\r\n        if (obj.height) layerInfo.height = obj.height;\r\n      }\r\n\r\n      if (obj.type === \"image\") {\r\n        layerInfo.src = obj.getSrc?.();\r\n      }\r\n\r\n      return layerInfo;\r\n    });\r\n\r\n    console.log(\"ðŸ§  Canvas Layers:\", layers);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-4\">\r\n      <h2 className=\"text-2xl font-bold mb-4\">Edit Image</h2>\r\n      <div className=\"mb-4 flex flex-wrap gap-2\">\r\n        <button onClick={addText} className=\"bg-blue-500 text-white px-3 py-1 rounded\">Add Text</button>\r\n        <button onClick={addRectangle} className=\"bg-green-500 text-white px-3 py-1 rounded\">Add Rectangle</button>\r\n        <button onClick={addCircle} className=\"bg-purple-500 text-white px-3 py-1 rounded\">Add Circle</button>\r\n        <button onClick={addTriangle} className=\"bg-pink-500 text-white px-3 py-1 rounded\">Add Triangle</button>\r\n        <button onClick={addPolygon} className=\"bg-yellow-500 text-black px-3 py-1 rounded\">Add Polygon</button>\r\n        <button onClick={downloadImage} className=\"bg-black text-white px-3 py-1 rounded\">Download Image</button>\r\n        <button onClick={logCanvasLayers} className=\"bg-indigo-600 text-white px-4 py-2 rounded mt-4\">ðŸ§  Log Canvas Layers</button>\r\n      </div>\r\n      <canvas ref={canvasRef} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditorPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}